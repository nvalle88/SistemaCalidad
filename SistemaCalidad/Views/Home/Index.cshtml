@model SistemaCalidad.Models.BussinessViewModels.IndiceEstudiosViewModel



<div class="row">

    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark">
            <i class="fa-fw fa fa-home"></i> Laboratorio de Calidad <span>> Cuadro de Indicadores</span>
        </h1>
    </div>
    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8">
        <ul id="sparks" class="">
            <li class="sparks-info">
                <h5> Total Estudios <span class="txt-color-blue">@Model.Realizados</span></h5>
                <div class="sparkline txt-color-blue hidden-mobile hidden-md hidden-sm">
                    1300, 1877, 2500, 2577, 2000, 2100, 3000, 2700, 3631, 2471, 2700, 3631, 2471
                </div>
            </li>
            <li class="sparks-info">
                <h5> Cumple <span class="txt-color-greenDark"><i class="glyphicon glyphicon-thumbs-up"></i>&nbsp;@Model.CumplePorcentaje %</span></h5>
                <div class="sparkline txt-color-greenDark hidden-mobile hidden-md hidden-sm">
                    110,150,300,130,400,240,220,310,220,300, 270, 210
                </div>
            </li>
            <li class="sparks-info">
                <h5> No Cumple <span class="txt-color-redLight"><i class="glyphicon glyphicon-thumbs-down"></i>&nbsp;@Model.NoCumplePorcentaje %</span></h5>
                <div class="sparkline txt-color-redLight hidden-mobile hidden-md hidden-sm">
                    110,150,300,130,400,240,220,310,220,300, 270, 210
                </div>
            </li>
        </ul>
    </div>
</div>
<!-- widget grid -->
<section id="widget-grid" class="">

    <!-- row -->
    <div class="row">
        <article class="col-sm-12">
            <!-- new widget -->
            <div class="jarviswidget" id="wid-id-0" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false">
                <!-- widget options:
                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                data-widget-colorbutton="false"
                data-widget-editbutton="false"
                data-widget-togglebutton="false"
                data-widget-deletebutton="false"
                data-widget-fullscreenbutton="false"
                data-widget-custombutton="false"
                data-widget-collapsed="true"
                data-widget-sortable="false"

                -->
                <header>
                    <span class="widget-icon">
                        <i class="glyphicon glyphicon-stats txt-color-darken"></i>
                    </span>
                    <h2>Seguimiento Mensual </h2>

                    @*<ul class="nav nav-tabs pull-right in" id="myTab">

                            <li>
                                <a data-toggle="tab" href="#s3">
                                    <i class="fa fa-briefcase"></i> <span class="hidden-mobile hidden-tablet">Estudios Realizados</span>
                                </a>
                            </li>
                        </ul>*@

                </header>

                <!-- widget div-->
                <div class="no-padding">
                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">

                        test
                    </div>
                    <!-- end widget edit box -->

                    <div class="widget-body">
                        <!-- content -->
                        <div id="myTabContent" class="tab-content">
                            <div class="tab-pane fade" id="s3">
                                <div class="row no-space">
                                    <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                                        <span class="demo-liveupdate-1">
                                            <span class="onoffswitch-title">Live switch</span> <span class="onoffswitch">
                                                <input type="checkbox" name="start_interval" class="onoffswitch-checkbox" id="start_interval">
                                                <label class="onoffswitch-label" for="start_interval">
                                                    <span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span>
                                                    <span class="onoffswitch-switch"></span>
                                                </label>
                                            </span>
                                        </span>
                                        <div id="updating-chart" class="chart-large txt-color-blue"></div>

                                    </div>
                                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 show-stats">

                                        <div class="row">
                                            <div class="col-xs-6 col-sm-6 col-md-12 col-lg-12">
                                                <span class="text"> My Tasks <span class="pull-right">130/200</span> </span>
                                                <div class="progress">
                                                    <div class="progress-bar bg-color-blueDark" style="width: 65%;"></div>
                                                </div>
                                            </div>
                                            <div class="col-xs-6 col-sm-6 col-md-12 col-lg-12">
                                                <span class="text"> Transfered <span class="pull-right">440 GB</span> </span>
                                                <div class="progress">
                                                    <div class="progress-bar bg-color-blue" style="width: 34%;"></div>
                                                </div>
                                            </div>
                                            <div class="col-xs-6 col-sm-6 col-md-12 col-lg-12">
                                                <span class="text"> Bugs Squashed<span class="pull-right">77%</span> </span>
                                                <div class="progress">
                                                    <div class="progress-bar bg-color-blue" style="width: 77%;"></div>
                                                </div>
                                            </div>
                                            <div class="col-xs-6 col-sm-6 col-md-12 col-lg-12">
                                                <span class="text"> User Testing <span class="pull-right">7 Days</span> </span>
                                                <div class="progress">
                                                    <div class="progress-bar bg-color-greenLight" style="width: 84%;"></div>
                                                </div>
                                            </div>

                                            <span class="show-stat-buttons">
                                                <span class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                                    <a href="javascript:void(0);" class="btn btn-default btn-block hidden-xs">Generate PDF</a>
                                                </span> <span class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                                    <a href="javascript:void(0);" class="btn btn-default btn-block hidden-xs">Report a bug</a>
                                                </span>
                                            </span>

                                        </div>

                                    </div>
                                </div>

                                <div class="show-stat-microcharts">
                                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">

                                        <div class="easy-pie-chart txt-color-orangeDark" data-percent="33" data-pie-size="50">
                                            <span class="percent percent-sign">35</span>
                                        </div>
                                        <span class="easy-pie-title"> Server Load <i class="fa fa-caret-up icon-color-bad"></i> </span>
                                        <ul class="smaller-stat hidden-sm pull-right">
                                            <li>
                                                <span class="label bg-color-greenLight"><i class="fa fa-caret-up"></i> 97%</span>
                                            </li>
                                            <li>
                                                <span class="label bg-color-blueLight"><i class="fa fa-caret-down"></i> 44%</span>
                                            </li>
                                        </ul>
                                        <div class="sparkline txt-color-greenLight hidden-sm hidden-md pull-right" data-sparkline-type="line" data-sparkline-height="33px" data-sparkline-width="70px" data-fill-color="transparent">
                                            130, 187, 250, 257, 200, 210, 300, 270, 363, 247, 270, 363, 247
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                                        <div class="easy-pie-chart txt-color-greenLight" data-percent="78.9" data-pie-size="50">
                                            <span class="percent percent-sign">78.9 </span>
                                        </div>
                                        <span class="easy-pie-title"> Disk Space <i class="fa fa-caret-down icon-color-good"></i></span>
                                        <ul class="smaller-stat hidden-sm pull-right">
                                            <li>
                                                <span class="label bg-color-blueDark"><i class="fa fa-caret-up"></i> 76%</span>
                                            </li>
                                            <li>
                                                <span class="label bg-color-blue"><i class="fa fa-caret-down"></i> 3%</span>
                                            </li>
                                        </ul>
                                        <div class="sparkline txt-color-blue hidden-sm hidden-md pull-right" data-sparkline-type="line" data-sparkline-height="33px" data-sparkline-width="70px" data-fill-color="transparent">
                                            257, 200, 210, 300, 270, 363, 130, 187, 250, 247, 270, 363, 247
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                                        <div class="easy-pie-chart txt-color-blue" data-percent="23" data-pie-size="50">
                                            <span class="percent percent-sign">23 </span>
                                        </div>
                                        <span class="easy-pie-title"> Transfered <i class="fa fa-caret-up icon-color-good"></i></span>
                                        <ul class="smaller-stat hidden-sm pull-right">
                                            <li>
                                                <span class="label bg-color-darken">10GB</span>
                                            </li>
                                            <li>
                                                <span class="label bg-color-blueDark"><i class="fa fa-caret-up"></i> 10%</span>
                                            </li>
                                        </ul>
                                        <div class="sparkline txt-color-darken hidden-sm hidden-md pull-right" data-sparkline-type="line" data-sparkline-height="33px" data-sparkline-width="70px" data-fill-color="transparent">
                                            200, 210, 363, 247, 300, 270, 130, 187, 250, 257, 363, 247, 270
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                                        <div class="easy-pie-chart txt-color-darken" data-percent="36" data-pie-size="50">
                                            <span class="percent degree-sign">36 <i class="fa fa-caret-up"></i></span>
                                        </div>
                                        <span class="easy-pie-title"> Temperature <i class="fa fa-caret-down icon-color-good"></i></span>
                                        <ul class="smaller-stat hidden-sm pull-right">
                                            <li>
                                                <span class="label bg-color-red"><i class="fa fa-caret-up"></i> 124</span>
                                            </li>
                                            <li>
                                                <span class="label bg-color-blue"><i class="fa fa-caret-down"></i> 40 F</span>
                                            </li>
                                        </ul>
                                        <div class="sparkline txt-color-red hidden-sm hidden-md pull-right" data-sparkline-type="line" data-sparkline-height="33px" data-sparkline-width="70px" data-fill-color="transparent">
                                            2700, 3631, 2471, 2700, 3631, 2471, 1300, 1877, 2500, 2577, 2000, 2100, 3000
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane fade active in padding-10 no-padding-bottom" id="s1">


                                <div class="widget-body-toolbar bg-color-white smart-form" id="rev-toggles">

                                    <div class="inline-group">

                                        <label for="gra-0" class="checkbox">
                                            <input type="checkbox" name="gra-0" id="gra-0" checked="checked">
                                            <i></i> Ejecutados
                                        </label>
                                        <label for="gra-1" class="checkbox">
                                            <input type="checkbox" name="gra-1" id="gra-1" checked="checked">
                                            <i></i> Cumple
                                        </label>
                                        <label for="gra-2" class="checkbox">
                                            <input type="checkbox" name="gra-2" id="gra-2" checked="checked">
                                            <i></i> No Cumple
                                        </label>
                                    </div>



                                </div>

                                <div class="padding-10">
                                    <div id="flotcontainer" class="chart-large has-legend-unique"></div>
                                </div>

                            </div>



                            <!-- end s3 tab pane -->
                        </div>



                        <!-- end content -->
                    </div>

                </div>
                <!-- end widget div -->
            </div>
            <!-- end widget -->

        </article>
    </div>

    <!-- end row -->
    <!-- row -->

    <div class="row">





    </div>

    <!-- end row -->

</section>
<!-- end widget grid -->
@section Scripts {




    <script>

       

     

        mostrarLoadingPanel("content", "");
        $(function() {
            /*
             * PAGE RELATED SCRIPTS
             */

            $(".js-status-update a").click(function() {
                var selText = $(this).text();
                var $this = $(this);
                $this.parents('.btn-group').find('.dropdown-toggle').html(selText + ' <span class="caret"></span>');
                $this.parents('.dropdown-menu').find('li').removeClass('active');
                $this.parent().addClass('active');
            });

            /*
            * TODO: add a way to add more todo's to list
            */

            // initialize sortable
            $(function() {
                $("#sortable1, #sortable2").sortable({
                    handle: '.handle',
                    connectWith: ".todo",
                    update: countTasks
                }).disableSelection();
            });

            // check and uncheck
            $('.todo .checkbox > input[type="checkbox"]').click(function() {
                var $this = $(this).parent().parent().parent();

                if ($(this).prop('checked')) {
                    $this.addClass("complete");

                    // remove this if you want to undo a check list once checked
                    //$(this).attr("disabled", true);
                    $(this).parent().hide();

                    // once clicked - add class, copy to memory then remove and add to sortable3
                    $this.slideUp(500,
                        function() {
                            $this.clone().prependTo("#sortable3").effect("highlight", {}, 800);
                            $this.remove();
                            countTasks();
                        });
                } else {
                    // insert undo code here...
                }
            });

            // count tasks
            function countTasks() {

                $('.todo-group-title').each(function() {
                    var $this = $(this);
                    $this.find(".num-of-tasks").text($this.next().find("li").size());
                });

            }

            /*
            * RUN PAGE GRAPHS
            */

            /* TAB 1: UPDATING CHART */
            // For the demo we use generated data, but normally it would be coming from the server

            var data = [], totalPoints = 200, $UpdatingChartColors = $("#updating-chart").css('color');

            function getRandomData() {
                if (data.length > 0)
                    data = data.slice(1);

                // do a random walk
                while (data.length < totalPoints) {
                    var prev = data.length > 0 ? data[data.length - 1] : 50;
                    var y = prev + Math.random() * 10 - 5;
                    if (y < 0)
                        y = 0;
                    if (y > 100)
                        y = 100;
                    data.push(y);
                }

                // zip the generated y values with the x values
                var res = [];
                for (var i = 0; i < data.length; ++i)
                    res.push([i, data[i]]);
                return res;
            }

            // setup control widget
            var updateInterval = 1500;
            $("#updating-chart").val(updateInterval).change(function() {

                var v = $(this).val();
                if (v && !isNaN(+v)) {
                    updateInterval = +v;
                    $(this).val("" + updateInterval);
                }

            });

            // setup plot
            var options = {
                yaxis: {
                    min: 0,
                    max: 100
                },
                xaxis: {
                    min: 0,
                    max: 100
                },
                colors: [$UpdatingChartColors],
                series: {
                    lines: {
                        lineWidth: 1,
                        fill: true,
                        fillColor: {
                            colors: [
                                {
                                    opacity: 0.4
                                }, {
                                    opacity: 0
                                }
                            ]
                        },
                        steps: false

                    }
                }
            };

            var plot = $.plot($("#updating-chart"), [getRandomData()], options);
            var $on = false;

            /* live switch */
            $('input[type="checkbox"]#start_interval').click(function() {
                if ($(this).prop('checked')) {
                    $on = true;
                    updateInterval = 1500;
                    update();
                } else {
                    clearInterval(updateInterval);
                    $on = false;
                }
            });

            function update() {
                if ($on == true) {
                    plot.setData([getRandomData()]);
                    plot.draw();
                    setTimeout(update, updateInterval);

                } else {
                    clearInterval(updateInterval);
                }

            }

            /*end updating chart*/



            // TAB THREE GRAPH //
            /* TAB 3: Revenew  */
            var indices = [];

            $.ajax({
                    type: 'GET',
                    url: '@Url.Action("Indices")',
                    dataType: 'json',
                    success: function (data) {
                        indicesFunction(data.indices,data.indicesCumple, data.indicesNoCumple)

                    }, complete: function (data) {
                        $("#content").waitMe("hide");
                    },
                    error: function (ex) {
                        alert('Failed to retrieve data.' + ex);
                    }
            });


            function indicesFunction(indices, indicesCumple, indicesNoCumple) {


                var data = new Array(1);

                for (var x = 0; x < indices.length; x++) {
                    data.push(new Array(Date.parse(indices[x].fecha), indices[x].realizados))
                }

                var data1 = new Array(1);

                for (var x = 0; x < indicesCumple.length; x++) {
                    data1.push(new Array(Date.parse(indicesCumple[x].fecha), indicesCumple[x].realizados))
                }


                var data2 = new Array(1);

                for (var x = 0; x < indicesNoCumple.length; x++) {
                    data2.push(new Array(Date.parse(indicesNoCumple[x].fecha), indicesNoCumple[x].realizados))
                }

               var trgt = data
                    //[
                    //    [indices[0].periodo, 900], [1364587000000, 65], [1374588000000, 98], [1384589000000, 83],
                    //    [1394590000000, 980], [1404591000000, 808], [1414592000000, 720], [1424593000000, 674],
                    //    [1434594000000, 23], [1444595000000, 79], [1454596000000, 88], [1464597000000, 36]
                    //]
                    ,
                    prft = data1
                    //[
                    //    [1354586000000, 53], [1364587000000, 65], [1374588000000, 98], [1384589000000, 83],
                    //    [1394590000000, 980], [1404591000000, 808], [1414592000000, 720], [1424593000000, 674],
                    //    [1434594000000, 23], [1444595000000, 79], [1454596000000, 88], [1464597000000, 36]
                    //   ]
                   ,
                   sgnups = data2
                    //   [
                    //    [1354586000000, 647], [1364587000000, 435], [1374588000000, 784], [1384589000000, 346],
                    //    [1394590000000, 487], [1404591000000, 463], [1414592000000, 479], [1424593000000, 236],
                    //    [1434594000000, 843], [1444595000000, 657], [1454596000000, 241], [1464597000000, 341]
                    //]
                    ,
                    toggles = $("#rev-toggles"),
                    target = $("#flotcontainer");

                var data = [
                    {
                        label: "Estudios Realizados",
                        data: trgt,
                        color:"#1d62d1",
                        bars: {
                            show: true,
                            align: "center",
                            barWidth: 30 * 30 * 30 * 50 * 30
                        }
                    }, {
                        label: "Cumple",
                        data: prft,
                        color: '#27a009',
                        lines: {
                            show: true,
                            lineWidth: 2
                        },
                        points: {
                            show: true
                        }
                    }, {
                        label: "No Cumple",
                        data: sgnups,
                        color: '#c90e27',
                        lines: {
                            show: true,
                            lineWidth: 2
                        },
                        points: {
                            show: true
                        }
                    }
                ];

                var options = {
                    grid: {
                        hoverable: true
                    },
                    tooltip: true,
                    tooltipOpts: {
                        content: 'Fecha:%x    - Cantidad:%y ',
                        dateFormat: '%b %y',
                        defaultTheme: false
                    },
                    xaxis: {
                        mode: "time"
                    },
                    yaxes: {
                        tickFormatter: function(val, axis) {
                            return  val;
                        },
                        max: 1200
                    }

                };

                var plot2 = null;

                function plotNow() {
                    var d = [];
                    toggles.find(':checkbox').each(function() {
                        if ($(this).is(':checked')) {
                            d.push(data[$(this).attr("name").substr(4, 1)]);
                        }
                    });
                    if (d.length > 0) {
                        if (plot2) {
                            plot2.setData(d);
                            plot2.draw();
                        } else {
                            plot2 = $.plot(target, d, options);
                        }
                    }

                };

                toggles.find(':checkbox').on('change',
                    function() {
                        plotNow();
                    });
                plotNow();
                $("#content").waitMe("hide");
            };
        });
    </script>
}
